---
import Footer from "@components/navigation/footer/Footer.astro";
import MainNavigation from "@components/navigation/main-nav/MainNav.astro";
import Components from "@components/utils/renderBlock.astro";
import footerData from "@data/footer.json";
import mainNavData from "@data/mainNav.json";
import Layout from "@layouts/BaseLayout.astro";

type Props = {
  frontmatter?: {
    title: string;
    description?: string;
    keywords?: string[];
    image?: string;
    canonical?: string;
    pageSections?: any[];
  };
  title?: string;
  description?: string;
  keywords?: string[];
  image?: string;
  canonical?: string;
  mainNav?: Record<string, any>;
  footer?: Record<string, any>;
};

const {
  frontmatter,
  title: titleProp,
  description: descriptionProp,
  keywords: keywordsProp,
  image: imageProp,
  canonical: canonicalProp,
  mainNav = mainNavData,
  footer = footerData,
} = Astro.props as Props;

const title = frontmatter?.title ?? titleProp ?? "";
const description = frontmatter?.description ?? descriptionProp;
const keywords = frontmatter?.keywords ?? keywordsProp;
const image = frontmatter?.image ?? imageProp;
const canonical = frontmatter?.canonical ?? canonicalProp;
const pageSections = frontmatter?.pageSections;
const hasPageSections = pageSections && pageSections.length > 0;
const hasSlotContent = Astro.slots.has("default");
---

<Layout
  title={title}
  description={description}
  keywords={keywords}
  image={image}
  canonical={canonical}
>
  <MainNavigation {...mainNav} />
  <main data-pagefind-body>
    {
      hasPageSections ? (
        <Components contentSections={pageSections} propName="pageSections" />
      ) : hasSlotContent ? (
        <slot />
      ) : null
    }
  </main>
  <Footer {...footer} />
</Layout>
