---
const { contentBlocks } = Astro.props;
const components = {};
const componentImports = import.meta.glob("../components/**/index.astro", {
  eager: true,
});

Object.entries(componentImports).forEach(([path, obj]) => {
  // Extract the component path from the full import path
  const relativePath = path.replace("../components/", "");
  const withoutExtension = relativePath.replace("/index.astro", "");
  const parts = withoutExtension.split("/");

  // Create the bookshop name (e.g., "elements/Button")
  const bookshopName = parts.join("/");

  components[bookshopName] = (obj as any).default;
});
---

<main>
  {
    contentBlocks?.map((block, index) => {
      const Component = components[block._bookshop_name];

      if (Component) {
        return <Component {...block} />;
      }
      return null;
    })
  }
</main>
