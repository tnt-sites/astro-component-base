---
import Component from "@components/utils/renderBlock.astro";

const {
  firstColumnContentBlocks = [],
  secondColumnContentBlocks = [],
  distributionMode = "half",
  verticalAlignment = "top",
  reverse = false,
  fixedWidth,
  class: className,
  ...rest
} = Astro.props;

const htmlAttributes = Object.fromEntries(
  Object.entries(rest).filter(([key]) => !key.startsWith("_"))
);

// Get content blocks based on reverse setting
const firstContentBlocks = reverse ? secondColumnContentBlocks : firstColumnContentBlocks;
const secondContentBlocks = reverse ? firstColumnContentBlocks : secondColumnContentBlocks;

const getReversedDistributionMode = (mode: string) => {
  const reverseMap = {
    "third-two-thirds": "two-thirds-third",
    "two-thirds-third": "third-two-thirds",
    "quarter-three-quarters": "three-quarters-quarter",
    "three-quarters-quarter": "quarter-three-quarters",
    "fixed-flexible": "flexible-fixed",
    "flexible-fixed": "fixed-flexible",
    half: "half",
  };

  return reverseMap[mode as keyof typeof reverseMap] || mode;
};

const finalDistributionMode = reverse
  ? getReversedDistributionMode(distributionMode)
  : distributionMode;
---

<section
  class:list={["split", `align-${verticalAlignment}`, finalDistributionMode, className]}
  style={fixedWidth ? `--split-fixed-width: ${fixedWidth}px;` : ""}
  {...htmlAttributes}
>
  <div class="pane first">
    <Component contentBlocks={firstContentBlocks} />
    {reverse ? <slot name="second" /> : <slot name="first" />}
  </div>
  <div class="pane second">
    <Component contentBlocks={secondContentBlocks} />
    {reverse ? <slot name="first" /> : <slot name="second" />}
  </div>
</section>
