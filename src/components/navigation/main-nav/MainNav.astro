---
import CustomSection from "@builders/custom-section/CustomSection.astro";
import Bar from "@components/navigation/bar/Bar.astro";
import Mobile from "@components/navigation/mobile/Mobile.astro";
import Image from "@core-elements/image/Image.astro";
import ButtonGroup from "@wrappers/button-group/ButtonGroup.astro";

const {
  logoSource,
  logoAlt = "logo",
  navData = [],
  buttonSections = [],
  class: className,
  _component,
  ...htmlAttributes
} = Astro.props;

const mobileNavData = [
  ...navData,
  ...buttonSections.map((button: any) => ({
    name: button.text || "Button",
    path: button.href || "#",
    children: [],
  })),
];
---

<CustomSection
  maxContentWidth="2xl"
  paddingHorizontal="lg"
  paddingVertical="none"
  class:list={["main-nav", className]}
  {...htmlAttributes}
>
  <a href="/">
    <Image source={logoSource} class="main-nav-logo" alt={logoAlt} editable={false} />
  </a>
  <div class="nav-end">
    <Bar navData={navData} class="desktop-main-nav" />

    <ButtonGroup
      direction="row"
      align="center"
      class="desktop-button-group"
      buttonSections={buttonSections}
      editable={false}
    />
  </div>
  <Mobile
    logoSource={logoSource}
    logoAlt={logoAlt}
    navData={mobileNavData}
    class="mobile-main-nav"
  />
</CustomSection>

<style lang="pcss" is:global>
  @layer page-sections {
    .main-nav {
      z-index: var(--layer-2);
      background-color: var(--color-bg); 
      padding-block: var(--spacing-md);
      position: sticky; 
      top: 0;

      .desktop-main-nav.bar,
      .desktop-button-group.button-group {
        @container (max-width: 768px) {
          display: none;
        }
      }

      .main-nav-logo {
        margin-top: 0 !important;
      }

      .nav-hamburger.mobile-button {
        @container (min-width: 769px) {
          display: none;
        }
      }

      > .outer-content > .content {
        align-items: center;
        container-type: inline-size;
        display: flex;
        flex-wrap: wrap;
        gap: var(--spacing-md);

        > a > .image img {
          height: 1.8em;
          max-width: min(20em, 100%);
          width: auto;
        }

        .button-group {
          margin-top: 0;
        }
      }

      > .outer-content > .content > .nav-end {
        align-items: center;
        display: flex;
        justify-content: flex-end;
        margin-left: auto;
        flex-shrink: 0;

        > .button-group {
          container-type: normal;
        }
      }
    }
  }
</style>
