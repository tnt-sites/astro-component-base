---
import Image from "@components/elements/image/image.astro";
import Bar from "@components/navigation/bar/bar.astro";
import Mobile from "@components/navigation/mobile/mobile.astro";
import ButtonGroup from "@components/wrappers/button-group/button-group.astro";
import Container from "@components/wrappers/container/container.astro";

const {
  logoSource,
  logoAlt = "logo",
  navData = [],
  buttonBlocks = [],
  class: className,
  ...rest
} = Astro.props;

const mobileNavData = [
  ...navData,
  ...buttonBlocks.map((button: any) => ({
    name: button.text || "Button",
    path: button.href || "#",
    children: [],
  })),
];
---

<Container
  maxContentWidth="2xl"
  paddingHorizontal="md"
  paddingVertical="none"
  class:list={["main-nav", className]}
  {...rest}
>
  {logoSource && <Image source={logoSource} alt={logoAlt} editable={false} />}
  <div style=" align-items: center;display: flex;">
    <Bar navData={navData} class="desktop-main-nav" />

    {
      buttonBlocks.length > 0 && (
        <ButtonGroup
          direction="row"
          align="center"
          class="desktop-button-group"
          buttonBlocks={buttonBlocks}
          editable={false}
        />
      )
    }
  </div>
  <Mobile
    logoSource={logoSource}
    logoAlt={logoAlt}
    navData={mobileNavData}
    class="mobile-main-nav"
  />
</Container>

<style lang="pcss">
  .main-nav {
    z-index: var(--layer-2);
    :global(.desktop-main-nav.bar),
    :global(.desktop-button-group.button-group) {
      @container (max-width: 768px) {
        display: none;
      }
    }

    :global(.nav-hamburger.mobile-button) {
      @container (min-width: 769px) {
        display: none;
      }
    }

    > :global(.outer-content) > :global(.content) {
      align-items: center;
      container-type: inline-size;
      display: flex;
      flex-wrap: wrap;
      gap: var(--spacing-md);
      justify-content: space-between;

      > :global(.image img) {
        height: 1.8em;
        max-width: min(20em, 100%);
        width: auto;
      }

      :global(.button-group) {
        margin-top: 0;
      }
    }
  }
</style>
