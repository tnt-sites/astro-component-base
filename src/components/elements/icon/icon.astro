---
import { Icon as AstroIcon } from "astro-icon/components";
import clsx from "clsx";

const { name, size, background, className, ...rest } = Astro.props;

const isValidName = name && name.trim();

if (!isValidName) {
  console.warn("Icon component received empty or invalid name:", name);
}

const htmlAttributes = Object.fromEntries(
  Object.entries(rest).filter(([key]) => !key.startsWith("_"))
);

const classNames = clsx(
  "icon",
  `size-${size}`,
  background && `background-${background}`,
  name?.includes("social/") && "fill",
  className
);
---

{isValidName && <AstroIcon name={name} class:list={classNames} {...htmlAttributes} />}

<style>
  .icon {
    all: unset;
    border: 1px solid transparent;
    border-radius: var(--radius-xs);
    color: var(--color-text-on-muted);
    display: inline-block;
    line-height: 0;
    vertical-align: middle;

    &.flip-rtl {
      transform: scaleX(-1);
    }

    &.background-subtle {
      padding: var(--spacing-em-xs);
    }

    &.background-subtle {
      background-color: var(--color-bg-surface);
    }

    &.fill {
      fill: currentcolor;
    }

    &.size-sm {
      font-size: var(--font-size-sm);
    }

    &.size-md {
      font-size: var(--font-size-xl);
    }

    &.size-lg {
      font-size: var(--font-size-3xl);
    }

    svg {
      max-height: 100%;
    }
  }
</style>
