---
import clsx from "clsx";
import Icon from "../icon/icon.astro";
// @ts-ignore
import MarkdownIt from "markdown-it";

const {
  text,
  level = "h2",
  size,
  align = "start",
  iconName,
  iconPosition = "before",
  class: className,
  ...rest
} = Astro.props;

const htmlAttributes = Object.fromEntries(
  Object.entries(rest).filter(([key]) => !key.startsWith("_"))
);

const md = MarkdownIt({ html: true });
const MarkdownText = text ? md.renderInline(text) : "";

const classNames = clsx("heading", size && `size-${size}`, `align-${align}`, className);

const Tag = level;
---

<Tag class:list={classNames} {...htmlAttributes}>
  {
    iconName && iconPosition == "before" && (
      <Icon
        name={iconName}
        size="none"
        class="heading-icon"
        aria-hidden="true"
        role="presentation"
      />
    )
  }
  <span class="heading-text" set:html={MarkdownText} />
  {
    iconName && iconPosition === "after" && (
      <Icon
        name={iconName}
        size="none"
        class="heading-icon heading-icon-after"
        aria-hidden="true"
        role="presentation"
      />
    )
  }
</Tag>

<style>
  .heading {
    .heading-icon {
      position: relative;
      bottom: 0.1em;
      margin-inline-end: 0.2em;

      &.heading-icon-after {
        margin-inline-end: 0;
        margin-inline-start: 0.2em;
      }
    }

    &.size-xs {
      font-size: var(--font-size-xs);
    }

    &.size-sm {
      font-size: var(--font-size-sm);
    }

    &.size-md {
      font-size: var(--font-size-md);
    }

    &.size-lg {
      font-size: var(--font-size-lg);
    }

    &.size-xl {
      font-size: var(--font-size-xl);
    }

    &.size-2xl {
      font-size: var(--font-size-2xl);
    }

    &.size-3xl {
      font-size: var(--font-size-3xl);
    }

    &.size-4xl {
      font-size: var(--font-size-4xl);
    }

    &.size-5xl {
      font-size: var(--font-size-5xl);
    }

    &.size-6xl {
      font-size: var(--font-size-6xl);
    }

    &.align-start {
      text-align: start;
    }

    &.align-center {
      text-align: center;
    }

    &.align-end {
      text-align: end;
    }
  }
</style>
