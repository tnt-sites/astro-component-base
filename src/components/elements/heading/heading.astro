---
import clsx from "clsx";
import Icon from "../icon/icon.astro";
// @ts-ignore
import MarkdownIt from "markdown-it";
import "./heading.pcss";

const {
  text,
  level = "h2",
  size,
  align = "start",
  iconName,
  iconPosition = "before",
  class: className,
  ...rest
} = Astro.props;

const htmlAttributes = Object.fromEntries(
  Object.entries(rest).filter(([key]) => !key.startsWith("_"))
);

const md = MarkdownIt({ html: true });
const MarkdownText = text ? md.renderInline(text) : "";

const classNames = clsx("heading", size && `size-${size}`, `align-${align}`, className);

const Tag = level;
---

<Tag class:list={classNames} {...htmlAttributes}>
  {
    iconName && iconPosition == "before" && (
      <Icon
        name={iconName}
        size="none"
        class="heading-icon"
        aria-hidden="true"
        role="presentation"
      />
    )
  }
  <span class="heading-text" set:html={MarkdownText} />
  {
    iconName && iconPosition === "after" && (
      <Icon
        name={iconName}
        size="none"
        class="heading-icon heading-icon-after"
        aria-hidden="true"
        role="presentation"
      />
    )
  }
</Tag>
