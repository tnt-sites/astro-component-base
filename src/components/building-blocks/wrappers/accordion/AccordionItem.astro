---
import RenderBlock from "@components/utils/renderBlock.astro";
import Icon from "@core-elements/icon/Icon.astro";

const {
  title,
  contentSections,
  isOpen = false,
  accordionName,
  _component,
  ...htmlAttributes
} = Astro.props;
---

<details class="accordion-item" open={isOpen} name={accordionName} {...htmlAttributes}>
  <summary class="accordion-item-title">
    <span class="accordion-item-title-text">{title}</span>
    <Icon name="chevron-down" size="none" class="accordion-item-icon" />
  </summary>
  <div class="accordion-item-detail">
    <slot>
      {contentSections && <RenderBlock contentSections={contentSections} />}
    </slot>
  </div>
</details>

<style lang="pcss" is:global>
  @layer components {
    .accordion-item {
    border-bottom: 1px solid var(--color-border-subtle);
    container-type: inline-size;

    > .accordion-item-title {
      align-items: center;
      cursor: pointer;
      display: flex;
      font-size: var(--font-size-xl);
      font-weight: var(--font-weight-bold);
      justify-content: space-between;
      padding: var(--spacing-md);
      transition: background-color var(--animation-normal) ease-out;
      -webkit-user-select: none;
      -ms-user-select: none;
      user-select: none;

      &:first-of-type {
        list-style-type: none;
      }

      &:hover {
        background-color: var(--color-bg-surface);
      }

      &::-webkit-details-marker {
        display: none;
      }

      .accordion-item-icon {
        transition: transform var(--animation-normal) ease-out;
      }
    }

    > .accordion-item-detail {
      padding-inline: var(--spacing-md);
      padding-bottom: var(--spacing-md);

      > editable-array > editable-array-item:first-child > *:first-child,
      > :not(editable-array):first-child {
        margin-top: 0 !important;
      }
    }
  }

  .accordion-item[open] {
    > .accordion-item-title .accordion-item-icon {
      transform: rotate(180deg);
    }

    > .accordion-item-detail {
      animation: grow-out 300ms ease-out;
    }
  }
  }
</style>
