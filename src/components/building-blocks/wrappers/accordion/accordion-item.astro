---
import Icon from "@components/building-blocks/core-elements/icon/icon.astro";
import RenderBlock from "@components/utils/renderBlock.astro";

const { title, contentBlocks, isOpen = false, accordionName, ...rest } = Astro.props;

const htmlAttributes = Object.fromEntries(
  Object.entries(rest).filter(([key]) => key !== "_component")
);
---

<details class="item" open={isOpen} name={accordionName} {...htmlAttributes}>
  <summary class="title">
    <span class="text">{title}</span>
    <Icon name="chevron-up" size="none" />
  </summary>
  <div class="detail">
    {contentBlocks ? <RenderBlock contentBlocks={contentBlocks} /> : <slot />}
  </div>
</details>

<style lang="pcss">
  .item {
    border-bottom: 1px solid var(--color-border-subtle);

    > .title {
      align-items: center;
      cursor: pointer;
      display: flex;
      font-size: var(--font-size-xl);
      font-weight: var(--font-weight-bold);
      justify-content: space-between;
      padding: var(--spacing-md);
      transition: background-color var(--animation-normal) ease-out;
      -webkit-user-select: none;
      -ms-user-select: none;
      user-select: none;

      &:first-of-type {
        list-style-type: none;
      }

      &:hover {
        background-color: var(--color-bg-surface);
      }

      &::-webkit-details-marker {
        display: none;
      }

      .icon {
        transition: transform var(--animation-normal) ease-out;
      }
    }

    > .detail {
      padding-inline: var(--spacing-md);
      padding-bottom: var(--spacing-md);
    }
  }

  .item[open] {
    > .title .icon {
      transform: rotate(180deg);
    }

    > .detail {
      animation: grow-out 300ms ease-out;
    }
  }
</style>
