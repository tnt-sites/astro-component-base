---
// @ts-ignore
import markdownit from "markdown-it";

const md = markdownit({ html: true });

const {
  text = "",
  alignX = "start",
  class: className,
  editable = true,
  "data-prop": customDataProp = "text",
  _component,
  ...htmlAttributes
} = Astro.props;

const markdownContent = text ? md.render(text) : "";

const textDataAttributes =
  editable && customDataProp
    ? {
        "data-editable": "text",
        "data-prop": customDataProp,
      }
    : {};

const hasText = text?.trim().length > 0;
const slotContent = Astro.slots.has("default") ? await Astro.slots.render("default") : null;
const hasSlotContent = (slotContent?.toString().trim().length ?? 0) > 0;

if (!_component && !hasText && !hasSlotContent) return;
---

<div
  class:list={["text", className, `align-${alignX}`]}
  {...htmlAttributes}
  {...textDataAttributes}
>
  <slot>
    {text && <Fragment set:html={markdownContent} />}
  </slot>
</div>

<style lang="pcss" is:global>
  @layer components {
    .text {
      margin-top: var(--spacing-lg);

      &.align-start {
        text-align: start;
      }

      &.align-center {
        text-align: center;
      }

      &.align-end {
        text-align: end;
      }
    }
  }
</style>
